<header class="bg-white shadow-sm sticky top-0 z-10">
  <div class="max-w-7xl mx-auto p-4 flex justify-between items-center">
    <a
      routerLink="/"
      class="text-3xl font-extrabold text-indigo-600 transition hover:text-indigo-700"
      >Athena</a
    >
    <nav class="hidden md:flex space-x-6">
      <a routerLink="/kids" class="text-gray-600 hover:text-indigo-600 transition">For Kids</a>
      <a routerLink="/parents" class="text-gray-600 hover:text-indigo-600 transition"
        >For Parents</a
      >
      <a routerLink="/teachers" class="text-gray-600 hover:text-indigo-600 transition"
        >For Teachers</a
      >
    </nav>

    <div class="flex space-x-3">
      @if (isLoggedIn()) {
      <div class="relative">
        <button
          #menuButton
          class="h-10 w-10 rounded-full shadow-lg hover:shadow-xl transition font-medium flex items-center justify-center border border-indigo-100 bg-white"
          type="button"
          (click)="toggleMenu()"
        >
          <app-avatar
            [picture]="profile()?.picture ?? ''"
            [full_name]="profile()?.full_name ?? profile()?.email ?? ''"
            sizeClass="w-10 h-10"
            bgClass="bg-indigo-50"
            borderClass="border border-indigo-100"
          />
        </button>

        @if (menuOpen()) {
        <div
          #menuPanel
          class="absolute right-0 mt-2 w-48 bg-white border border-gray-200 rounded-xl shadow-lg py-2 z-20"
        >
        <a
          routerLink="/dashboard"
          class="flex items-center px-4 py-2 text-gray-700 hover:bg-gray-100 space-x-2"
          (click)="closeMenu()"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="lucide lucide-layout-dashboard"
            >
              <rect width="7" height="9" x="3" y="3" rx="1" />
              <rect width="7" height="5" x="14" y="3" rx="1" />
              <rect width="7" height="9" x="14" y="12" rx="1" />
              <rect width="7" height="5" x="3" y="16" rx="1" />
            </svg>
            <span>Dashboard</span>
          </a>
          <a
            [routerLink]="profileLink()"
            class="flex items-center px-4 py-2 text-gray-700 hover:bg-gray-100 space-x-2"
            (click)="goToProfile($event)"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="lucide lucide-user-round"
            >
              <circle cx="12" cy="8" r="4" />
              <path d="M6 20a6 6 0 0 1 12 0" />
            </svg>
            <span>Profile</span>
          </a>
          <hr />
          <button
            class="flex items-center w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 space-x-2"
            (click)="logout()"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="lucide lucide-log-out"
            >
              <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
              <polyline points="16 17 21 12 16 7" />
              <line x1="21" x2="9" y1="12" y2="12" />
            </svg>
            <span>Logout</span>
          </button>
        </div>
        }
      </div>
      } @else {
      <button
        class="px-4 py-2 bg-indigo-600 text-white rounded-xl shadow-lg hover:bg-indigo-700 transition font-medium flex items-center space-x-2"
        routerLink="/login"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="20"
          height="20"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="lucide lucide-lock"
        >
          <rect width="18" height="11" x="3" y="11" rx="2" ry="2" />
          <path d="M7 11V7a5 5 0 0 1 10 0v4" />
        </svg>
        <span>Login</span>
      </button>
      }
    </div>
  </div>
</header>
