<div id="parent-content" role="tabpanel" aria-labelledby="parent-tab" class="role-content">
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
    <app-parent-child-list
      [children]="children() || []"
      [selectedChildId]="selectedChildId()"
      [loading]="parentLoading()"
      (selectChild)="selectChild($event)"
      (addChild)="openAddChildModal()"
    ></app-parent-child-list>

    <div class="lg:col-span-2 bg-white border border-teal-200 p-6 rounded-2xl shadow-xl">
      @if (parentLoading()) {
      <app-parent-child-loading />
      } @else if (selectedChild(); as child) {
      <app-parent-child-details
        [child]="child"
        [auditTrail]="auditTrail()"
        [actionMenuOpen]="actionMenuOpen()"
        [formatActivityTime]="formatActivityTime"
        (viewProfile)="goToChildOptions()"
        (actionRequested)="requestActionConfirmation($event)"
        (actionMenuToggle)="toggleActionMenu()"
        (moodSuggestionsRequested)="openMoodSuggestions()"
        (manageGoals)="goToLearningGoals()"
        (viewActivity)="goToActivity()"
      />
      } @else {
      <app-parent-empty-state />
      }
    </div>
  </div>

  @if (showAddChildModal()) {
  <app-parent-add-child-modal
    [child]="newChild()"
    (close)="closeAddChildModal()"
    (save)="saveChild()"
    (fieldChange)="onChildFieldChange($event.field, $event.value)"
  />
  } @if (pendingAction(); as pending) {
  <app-parent-action-confirm-modal
    [pending]="pending"
    (cancel)="cancelPendingAction()"
    (confirm)="confirmPendingAction()"
  />
  } @if (moodSuggestionsOpen()) {
  <app-parent-mood-suggestions
    [open]="moodSuggestionsOpen()"
    [suggestions]="moodSuggestions()"
    (close)="closeMoodSuggestions()"
  />
  }
</div>
